{"paragraphs":[{"text":"%pyspark\n\ndf = spark.read.csv(\"s3://phanpy1-demo-ecomm-bucket-stream/aggregated/2018/12/08/*\")","user":"anonymous","dateUpdated":"2018-12-08T18:26:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-8173670095740687043.py\", line 364, in <module>\n    code = compile('\\n'.join(stmts), '<stdin>', 'exec', ast.PyCF_ONLY_AST, 1)\n  File \"<stdin>\", line 2\n    df = df.withColumnRenamed(\"_c0\", \"sessionid\") \\\n                                                   ^\nSyntaxError: unexpected character after line continuation character\n"}]},"apps":[],"jobName":"paragraph_1544287845353_800771921","id":"20181208-165045_304686430","dateCreated":"2018-12-08T16:50:45+0000","dateStarted":"2018-12-08T18:25:19+0000","dateFinished":"2018-12-08T18:25:19+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1449"},{"text":"%pyspark\ndf.printSchema()","user":"anonymous","dateUpdated":"2018-12-08T18:25:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544290928238_447186795","id":"20181208-174208_1480581020","dateCreated":"2018-12-08T17:42:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1676","dateFinished":"2018-12-08T18:25:00+0000","dateStarted":"2018-12-08T18:25:00+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- sessionid: string (nullable = true)\n |-- userid: string (nullable = true)\n |-- _c2: string (nullable = true)\n |-- _c3: string (nullable = true)\n |-- _c4: string (nullable = true)\n |-- _c5: string (nullable = true)\n |-- _c6: string (nullable = true)\n |-- _c7: string (nullable = true)\n |-- _c8: string (nullable = true)\n |-- _c9: string (nullable = true)\n\n"}]}},{"text":"%pyspark\ndf.show()","user":"anonymous","dateUpdated":"2018-12-08T18:13:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544292790431_1540326469","id":"20181208-181310_1299851724","dateCreated":"2018-12-08T18:13:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2366","dateFinished":"2018-12-08T18:13:14+0000","dateStarted":"2018-12-08T18:13:13+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+---+----------+--------------------+---+-------------------+-------------------+-----+-----+---+\n|              _c0|_c1|       _c2|                 _c3|_c4|                _c5|                _c6|  _c7|  _c8|_c9|\n+-----------------+---+----------+--------------------+---+-------------------+-------------------+-----+-----+---+\n|227_BRO1544290560|227|   browser|2018-12-08 17:36:...|  4|   beer_vitrine_nav|beer_product_detail|36:01|36:48| 47|\n|235_BRO1544290560|235|   browser|2018-12-08 17:36:...|  6|   beer_vitrine_nav|beer_product_detail|36:01|36:38| 37|\n|315_APP1544290560|315|app_tablet|2018-12-08 17:36:...|  2|   beer_vitrine_nav|beer_product_detail|36:01|36:08|  7|\n|238_APP1544290560|238|app_tablet|2018-12-08 17:36:...|  2|      beer_checkout|   beer_vitrine_nav|36:01|36:43| 42|\n|227_APP1544290560|227|app_mobile|2018-12-08 17:36:...|  4|      beer_checkout|          beer_cart|36:01|36:44| 43|\n|102_APP1544290560|102|app_tablet|2018-12-08 17:36:...|  7|   beer_vitrine_nav|beer_product_detail|36:01|36:52| 50|\n|520_APP1544290560|520|app_tablet|2018-12-08 17:36:...|  6|   beer_vitrine_nav|   beer_vitrine_nav|36:01|36:46| 45|\n|231_APP1544290560|231|app_tablet|2018-12-08 17:36:...|  2|      beer_checkout|   beer_vitrine_nav|36:01|36:45| 43|\n|102_APP1544290560|102|app_mobile|2018-12-08 17:36:...|  4|   beer_vitrine_nav|beer_product_detail|36:01|36:51| 50|\n|302_BRO1544290560|302|   browser|2018-12-08 17:36:...|  7|   beer_vitrine_nav|          beer_cart|36:01|36:47| 45|\n|509_APP1544290560|509|app_tablet|2018-12-08 17:36:...|  4|   beer_vitrine_nav|   beer_vitrine_nav|36:01|36:53| 51|\n|347_APP1544290560|347|app_mobile|2018-12-08 17:36:...|  2|beer_product_detail|      beer_checkout|36:01|36:07|  5|\n|225_APP1544290560|225|app_tablet|2018-12-08 17:36:...|  6|beer_product_detail|   beer_vitrine_nav|36:01|36:47| 46|\n|318_APP1544290560|318|app_mobile|2018-12-08 17:36:...|  6|beer_product_detail|beer_product_detail|36:01|36:45| 43|\n|548_APP1544290560|548|app_mobile|2018-12-08 17:36:...|  6|beer_product_detail|   beer_vitrine_nav|36:01|36:48| 47|\n|405_APP1544290560|405|app_mobile|2018-12-08 17:36:...|  4|          beer_cart|      beer_checkout|36:01|36:53| 51|\n|130_BRO1544290560|130|   browser|2018-12-08 17:36:...|  5|          beer_cart|beer_product_detail|36:01|36:52| 50|\n|339_BRO1544290560|339|   browser|2018-12-08 17:36:...|  3|   beer_vitrine_nav|      beer_checkout|36:01|36:51| 50|\n|129_BRO1544290560|129|   browser|2018-12-08 17:36:...|  8|beer_product_detail|   beer_vitrine_nav|36:01|36:53| 51|\n|338_BRO1544290560|338|   browser|2018-12-08 17:36:...|  4|beer_product_detail|   beer_vitrine_nav|36:01|36:38| 36|\n+-----------------+---+----------+--------------------+---+-------------------+-------------------+-----+-----+---+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-89-228.ec2.internal:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n\n# df.printSchema()\n# df.write.option(\"path\", \"s3://phanpy1-demo-ecomm-bucket-stream/aggregated/tb_aggredated/\").saveAsTable(\"tb_aggregated\")\nspark.sql(\"drop table if exists tb_aggregated\")\ndf.write.saveAsTable(\"tb_aggregated\", format=\"orc\", path=\"s3://phanpy1-demo-ecomm-bucket-stream/aggregated/tb_aggredated\")\n# df.write.partitionBy(\"partition_0\", \"partition_1\", \"partition_2\", \"partition_3\").saveAsTable(\"tb_aggregated\", format=\"orc\", path=\"s3://phanpy1-demo-ecomm-bucket-stream/aggregated/tb_aggredated\")","user":"anonymous","dateUpdated":"2018-12-08T18:19:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1544287981045_847730627","id":"20181208-165301_1477206021","dateCreated":"2018-12-08T16:53:01+0000","dateStarted":"2018-12-08T18:19:29+0000","dateFinished":"2018-12-08T18:19:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1451","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-89-228.ec2.internal:4040/jobs/job?id=18"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nspark.sql(\"select count(1) from tb_aggregated\").show()\n","user":"anonymous","dateUpdated":"2018-12-08T18:30:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544288613925_86450434","id":"20181208-170333_1279899748","dateCreated":"2018-12-08T17:03:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1453","dateFinished":"2018-12-08T18:30:27+0000","dateStarted":"2018-12-08T18:30:26+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|count(1)|\n+--------+\n|   22368|\n+--------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-89-228.ec2.internal:4040/jobs/job?id=29"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndf1 = spark.read.json(\"s3://phanpy1-demo-ecomm-bucket-stream/rawdata/2018/12/08/12\")\ndf1.printSchema()","user":"anonymous","dateUpdated":"2018-12-08T18:28:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544293231963_-2031285042","id":"20181208-182031_1790682416","dateCreated":"2018-12-08T18:20:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2506","dateFinished":"2018-12-08T18:28:20+0000","dateStarted":"2018-12-08T18:28:11+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- custid: long (nullable = true)\n |-- device: string (nullable = true)\n |-- touchproduct: long (nullable = true)\n |-- trafficfrom: string (nullable = true)\n |-- trans_timestamp: string (nullable = true)\n |-- url: string (nullable = true)\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-89-228.ec2.internal:4040/jobs/job?id=24"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndf1.show()","user":"anonymous","dateUpdated":"2018-12-08T18:30:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544293643345_-1091602512","id":"20181208-182723_1927069894","dateCreated":"2018-12-08T18:27:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2930","dateFinished":"2018-12-08T18:28:39+0000","dateStarted":"2018-12-08T18:28:38+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+----------+------------+------------------+--------------------+-------------------+\n|custid|    device|touchproduct|       trafficfrom|     trans_timestamp|                url|\n+------+----------+------------+------------------+--------------------+-------------------+\n|   246|app_tablet|           0| email_MyFirstBeer|2018-12-08T12:52:...|   beer_vitrine_nav|\n|   529|app_tablet|          80|email_CampanhaBeer|2018-12-08T12:52:...|beer_product_detail|\n|   519|   browser|           0|        amazon.com|2018-12-08T12:52:...|   beer_vitrine_nav|\n|   509|app_mobile|           0|        amazon.com|2018-12-08T12:52:...|   beer_vitrine_nav|\n|   203|app_tablet|           0| email_MyFirstBeer|2018-12-08T12:52:...|   beer_vitrine_nav|\n|   350|app_mobile|           0|        amazon.com|2018-12-08T12:52:...|   beer_vitrine_nav|\n|   340|app_mobile|         248|        amazon.com|2018-12-08T12:52:...|          beer_cart|\n|   406|   browser|          59|      facebook.com|2018-12-08T12:52:...|beer_product_detail|\n|   447|app_mobile|          64|email_CampanhaBeer|2018-12-08T12:52:...|beer_product_detail|\n|   136|app_mobile|         193|        amazon.com|2018-12-08T12:52:...|beer_product_detail|\n|   124|app_mobile|          53|        amazon.com|2018-12-08T12:52:...|      beer_checkout|\n|   117|app_mobile|          81|      facebook.com|2018-12-08T12:52:...|beer_product_detail|\n|   322|app_tablet|           0| email_MyFirstBeer|2018-12-08T12:52:...|   beer_vitrine_nav|\n|   240|app_tablet|         184|      facebook.com|2018-12-08T12:52:...|beer_product_detail|\n|   235|   browser|         204|        amazon.com|2018-12-08T12:52:...|          beer_cart|\n|   200|app_tablet|           0|            google|2018-12-08T12:52:...|   beer_vitrine_nav|\n|   337|   browser|           0|      facebook.com|2018-12-08T12:52:...|   beer_vitrine_nav|\n|   425|app_tablet|         151|    Jao_Cervejeiro|2018-12-08T12:52:...|beer_product_detail|\n|   131|app_mobile|          31|        BeerHug_TV|2018-12-08T12:52:...|          beer_cart|\n|   411|   browser|           0|    Jao_Cervejeiro|2018-12-08T12:52:...|   beer_vitrine_nav|\n+------+----------+------------+------------------+--------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-89-228.ec2.internal:4040/jobs/job?id=26"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndf1.write.saveAsTable(\"tb_raw\", format=\"orc\", path=\"s3://phanpy1-demo-ecomm-bucket-stream/aggregated/tb_raw\")","user":"anonymous","dateUpdated":"2018-12-08T18:29:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544293707411_1990095506","id":"20181208-182827_82518190","dateCreated":"2018-12-08T18:28:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3139","dateFinished":"2018-12-08T18:30:03+0000","dateStarted":"2018-12-08T18:29:51+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-89-228.ec2.internal:4040/jobs/job?id=27"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nspark.sql(\"select count(1) from tb_raw\").show()","user":"anonymous","dateUpdated":"2018-12-08T18:30:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544293791281_199165984","id":"20181208-182951_1144674903","dateCreated":"2018-12-08T18:29:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3314","dateFinished":"2018-12-08T18:30:18+0000","dateStarted":"2018-12-08T18:30:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|count(1)|\n+--------+\n|   45108|\n+--------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-89-228.ec2.internal:4040/jobs/job?id=28"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-12-08T18:30:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544293817184_-451038836","id":"20181208-183017_2002603416","dateCreated":"2018-12-08T18:30:17+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3425"}],"name":"tarefa1_2","id":"2DZV7SKRS","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}